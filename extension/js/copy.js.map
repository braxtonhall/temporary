{"version":3,"file":"copy.js","mappings":";;;;;;;;;;AAAa;AACb,kBAAkB;AAClB,qBAAqB,GAAG,yBAAyB;AACjD;AACA,yBAAyB;AACzB;AACA,qBAAqB;;;;;;;;;;;ACNR;AACb,kBAAkB;AAClB,yBAAyB,GAAG,wBAAwB;AACpD,2CAA2C,wBAAwB,QAAQ;AAC3E,wBAAwB;AACxB,kDAAkD;AAClD,yBAAyB;;;;;;;UCNzB;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;;;;;;ACtBa;AACb,kBAAkB;AAClB,kBAAkB,mBAAO,CAAC,sCAAa;AACvC,aAAa,mBAAO,CAAC,4BAAQ;AAC7B;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA,6GAA6G;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA,KAAK,IAAI;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC","sources":["webpack:///./ts/constants.ts","webpack:///./ts/util.ts","webpack:///webpack/bootstrap","webpack:///./ts/copy.ts"],"sourcesContent":["\"use strict\";\nexports.__esModule = true;\nexports.RELEVANT_TAGS = exports.FORM_RENDER_EVENT = void 0;\nvar FORM_RENDER_EVENT = \"library-thing-form-rendered\";\nexports.FORM_RENDER_EVENT = FORM_RENDER_EVENT;\nvar RELEVANT_TAGS = [\"textarea\", \"input\", \"select\"];\nexports.RELEVANT_TAGS = RELEVANT_TAGS;\n","\"use strict\";\nexports.__esModule = true;\nexports.getElementsByTags = exports.getElementsByTag = void 0;\nvar getElementsByTag = function (parent) { return function (tag) { var _a; return Array.from((_a = parent === null || parent === void 0 ? void 0 : parent.getElementsByTagName(tag)) !== null && _a !== void 0 ? _a : []); }; };\nexports.getElementsByTag = getElementsByTag;\nvar getElementsByTags = function (parent, tags) { return tags.flatMap(getElementsByTag(parent)); };\nexports.getElementsByTags = getElementsByTags;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\"use strict\";\nexports.__esModule = true;\nvar constants_1 = require(\"./constants\");\nvar util_1 = require(\"./util\");\nvar COLLECTIONS_ID_PREFIX = \"collection_u_\";\nvar SAVE_DATA_KEY = \"_save-data\";\nvar COLLECTIONS_KEY = \"___collections_\";\nvar saveData = function (parent) { return function (event) {\n    event.preventDefault();\n    localStorage.setItem(SAVE_DATA_KEY, JSON.stringify(getSaveData(parent)));\n}; };\nvar loadData = function (parent) { return function (event) {\n    var _a;\n    event.preventDefault();\n    var saveData = JSON.parse((_a = localStorage.getItem(SAVE_DATA_KEY)) !== null && _a !== void 0 ? _a : \"{}\");\n    insertSaveData(parent, saveData);\n}; };\nvar getSaveData = function (parent) {\n    var elements = (0, util_1.getElementsByTags)(parent, constants_1.RELEVANT_TAGS);\n    return elements.reduce(function (saveData, element) {\n        // We can't change hidden elements because LibraryThing relies\n        // on hidden form inputs to send additional, form-specific metadata\n        // on save\n        if (element && element.id && element.type !== \"hidden\") {\n            var value = element.value, checked = element.checked;\n            if (element.id.startsWith(COLLECTIONS_ID_PREFIX)) {\n                var collections = saveData[COLLECTIONS_KEY] || {};\n                var span = element.parentElement.getElementsByTagName(\"span\")[0];\n                collections[span.textContent] = { value: value, checked: checked };\n                saveData[COLLECTIONS_KEY] = collections;\n            }\n            else {\n                saveData[element.id] = { value: value, checked: checked };\n            }\n        }\n        return saveData;\n    }, {});\n};\nvar insertSaveData = function (parent, saveData) {\n    var elements = (0, util_1.getElementsByTags)(parent, constants_1.RELEVANT_TAGS);\n    return elements.forEach(function (element) {\n        // We can't change hidden elements because LibraryThing relies\n        // on hidden form inputs to send additional, form-specific metadata\n        // on save\n        if (element && element.id && element.type !== \"hidden\") {\n            var saveElement = element;\n            if (element.id.startsWith(COLLECTIONS_ID_PREFIX)) {\n                var span = element.parentElement.getElementsByTagName(\"span\")[0];\n                saveElement = saveData[COLLECTIONS_KEY][span.textContent] || element;\n            }\n            else {\n                saveElement = saveData[element.id] || element;\n            }\n            element.value = saveElement.value;\n            element.checked = saveElement.checked;\n        }\n    });\n};\nvar appendButton = function (element, text, onClick) {\n    var button = document.createElement(\"button\");\n    button.innerHTML = text;\n    button.addEventListener(\"click\", onClick);\n    var td = document.createElement(\"td\");\n    td.appendChild(button);\n    element.appendChild(td);\n};\nvar appendRow = function (editForm) { return function (table) {\n    var row = document.createElement(\"tr\");\n    appendButton(row, \"SAVE\", saveData(editForm));\n    appendButton(row, \"LOAD\", loadData(editForm));\n    var body = Array.from(table.getElementsByTagName(\"tbody\"))[0];\n    body.appendChild(row);\n}; };\nwindow.addEventListener(constants_1.FORM_RENDER_EVENT, function () {\n    var editForm = document.getElementById(\"book_editForm\");\n    Array.from(document.getElementsByClassName(\"book_bitTable\")).forEach(appendRow(editForm));\n});\n"],"names":[],"sourceRoot":""}